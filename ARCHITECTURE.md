# 项目架构说明

这个项目已经按照 Iced 框架的最佳实践进行了重构，采用了分层架构设计。

## 项目结构

```
src/
├── main.rs              # 应用程序入口点
├── app.rs               # 主应用程序状态和逻辑
├── message.rs           # 消息类型定义
├── api.rs               # API 调用和错误处理
├── country.rs           # 国家和货币数据
├── http_utils.rs        # HTTP 工具函数
├── pages/               # 页面级组件
│   ├── mod.rs           
│   └── bitcoin_page.rs  # 比特币价格页面
└── views/               # UI 视图组件
    ├── mod.rs           
    └── bitcoin_view.rs  # 比特币价格视图
```

## 架构特点

### 1. 分层架构
- **应用层** (`app.rs`): 管理全局应用状态和路由
- **页面层** (`pages/`): 页面级业务逻辑和状态管理
- **视图层** (`views/`): 纯 UI 组件，负责渲染

### 2. 消息驱动
- **应用级消息** (`Message`): 顶层消息类型
- **页面级消息** (`BitcoinMessage`): 特定功能模块的消息

### 3. 错误处理
- 在 API 层添加了完善的错误处理
- 在 UI 中显示加载状态和错误信息

### 4. 关注点分离
- **业务逻辑**: 在页面组件中处理
- **UI 渲染**: 在视图组件中处理
- **数据获取**: 在 API 模块中处理

## 优化亮点

1. **模块化设计**: 每个功能模块职责单一，易于维护
2. **可扩展性**: 添加新页面只需在 `pages/` 目录下新增模块
3. **错误处理**: 完善的错误处理机制，提升用户体验
4. **生命周期管理**: 正确的 Rust 生命周期标注
5. **代码复用**: 视图组件可以被不同页面复用

## 使用方式

```bash
# 运行应用程序
cargo run

# 检查代码
cargo check

# 构建发布版本
cargo build --release
```

## 下一步扩展建议

1. 添加更多货币支持
2. 实现历史价格图表
3. 添加价格提醒功能
4. 支持多主题切换
5. 添加配置页面
